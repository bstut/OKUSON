\documentclass[12pt,openany,a4paper]{book}

% $Id: manual.tex,v 1.24 2003/10/10 00:18:50 luebeck Exp $

\parindent0.0em
\setlength{\parskip}{0.7ex plus 1.0ex}
\usepackage[latin1]{inputenc}
\usepackage{times}
\usepackage{calc}
\usepackage{a4wide}
\usepackage[colorlinks=true]{hyperref}

% avoid overfull hboxes because of long typewriter font strings
\tolerance=200
\setlength{\emergencystretch}{2em}

\newcommand{\OKUSON}{\textsf{OKUSON}}

\begin{document}
\title{\Huge \textbf {\OKUSON} Manual}
\author{Frank Lübeck\\Max Neunhöffer \\[2cm] Version \input{../VERSION}}
\maketitle
\tableofcontents

\chapter*{}
\section*{Copyright and License}

This software package is freely distributed under the terms of the GNU Public
License, see chapter~\ref{ch:GPL} for the details of that license.

\copyright\  (2003) Frank Lübeck and Max Neunhöffer

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Overview}

The {\OKUSON} package provides tools for offering exercise sheets via the
web. It grew out of programs written and used by the authors since several
semesters, when we had to organize exercise sessions accompanying beginners
courses in mathematics. Some of these courses had more than 1000 students.

The main purposes of the package are
\begin{itemize}
\item to enable the use of exercises which allow a mechanical check (multiple 
choice, yes-no questions, questions with easy to parse answers like numbers)
\item to automatize the management of the participants: registration for the
exercise course and exams, delivery of the exercise sheets via the web, 
collecting the  solutions of exercises as mentioned above via the web,
grading of these solutions, \ldots
\end{itemize}

A more detailed account of our motivation and the description of some
experiences can be found in the article:

\begin{center}
\begin{minipage}{\textwidth-1in}
   Frank Lübeck und Max Neunhöffer,
\href{http://www.math.rwth-aachen.de:8001/~Frank.Luebeck/preprints/AufgServCARweb.pdf}{Übungsbetrieb über Webservice}, \href{http://www.fachgruppe-computeralgebra.de/CAR}{Computer Algebra Rundbrief} \textbf{31}, Oktober 2002
\end{minipage}
\end{center}

Our technical goal was to provide a system which is based on reliable and
easy to install software on the server side and which only assumes any
computer with internet access, any web browser and any program for printing 
PDF-files on the side of the participating students.

\section{Contents of the {\OKUSON} Package}

In the archive of this package you find:
\begin{itemize}
\item a collection of program modules for the scripting language
\href{http://www.python.org}{Python};
some are generic tools, for example for reading and writing certain kinds of
data files, a builtin web server, handling of different types of template files,
\ldots, and some are specialized code for this package.
\item 
a copy of the  XML parser \href{http://www.reportlab.com/xml/pyrxp.html}{pyRXP} by Richard Tobin at the Language
Technology Group, Edinburgh, for use with Python.
\item
a complete set of sample web pages (in German) which are probably not
difficult to customize for other courses in other places. (The text on these
pages is the only language dependent part, such that an adjustment of this
package to other languages would be straight forward.)
\item 
a detailed documentation and usage guide.
\item
example exercises and exercise sheets.
\item 
checking utilities for {\OKUSON} exercises and sheets.
\end{itemize}

\section{How to Use this Manual}

\begin{itemize}
\item get started by reading and following chapter~\ref{ch:inst}, then you
already have a running server.
\item look at some of the examples of exercises and browse
chapters~\ref{ch:introXML} and~\ref{ch:createExercisesSheets} to
learn how to create the exercises and sheets for the service. 
\item chapter~\ref{ch:webpages} describes the customization of the web
pages, so read this if you need to adjust some details. 
\item consider some of the remarks in~\ref{sec:insttips} to make your 
installation more
secure and robust. Then you are ready to publish the web site for your
course.
\item the next few chapters describe some administrative tasks when the course
is running and the corresponding tools  in {\OKUSON}.
\item in the end there are some chapters on more techical aspects of the
package. These are mainly interesting if you want to add some functionality
to the package.
\end{itemize}

\section{Feedback}

We are interested  in all comments, suggestions,  extensions concerning this
package. Please, tell  us if you are  using the package for  some course. If
you create exercises and sheets in  {\OKUSON} format we would be greatful if
we could get a copy.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Installation}\label{ch:inst}

\section{Quick Installation Overview}

The following describes briefly how to get the {\OKUSON} package started on
your system.
Probably you want to use this section only to get an overview or as
a reminder for later installations when you already know the process.

All steps are explained in more detail in the next few sections. If you are
going to use {\OKUSON}  for a course, you may also want to consider the tips
and tricks in~\ref{sec:insttips}.

\begin{enumerate}
\setlength{\parskip}{0mm}
\item Make sure you have Python version 2.2 or later installed.
\item Download \texttt{okuson-XXX.tar.gz} from:

\hspace*{5mm}\href{http://www.math.rwth-aachen.de/~OKUSON}%
{\texttt{http://www.math.rwth-aachen.de/\~{}OKUSON}}

\item Extract archive with: 

\hspace*{5mm}\texttt{gzip -dc okuson-XXX.tar.gz | tar xvf -}
\item Compile \texttt{pyRXP} with: 

\hspace*{5mm}\texttt{cd okuson/server ; ./makepyRXP}
\item Leave the \texttt{server} directory with: 

\hspace*{5mm}\texttt{cd ..}
\item Copy \texttt{Config.xml.sample} to \texttt{Config.xml} by doing

\hspace*{5mm}\texttt{cp Config.xml.sample Config.xml}

and edit it to adjust at least the \texttt{AdministratorPassword}
(use \texttt{cryptpasswd} to encrypt your password) and maybe some 
other obvious entries in the course section of this configuration file.

\item Copy the sample web pages to the document root: 

\hspace*{5mm}\verb!cp -r html.sample/* html!
\item Copy empty data files to places where they belong:

\hspace*{5mm}\texttt{cd data ; cp empty/* . ; cd ..}
\item Start server with: 

\hspace*{5mm}\texttt{start}
\item Test server by pointing browser to 

\hspace*{5mm}\href{http://localhost:8000/index.html}%
{\texttt{http://localhost:8000/index.html}}

(substitute the \texttt{8000} if you have choosen another number in the
\texttt{Port} entry of the \texttt{Config.xml} file).
\item If things look alright, start customizing for your application:
have another look in the course section of the \texttt{Config.xml} file,
adjust details of the web pages (see~\ref{ch:webpages}), add information 
on tutoring groups (if applicable, see~\ref{sec:groups}), prepare the first
exercise sheets (see~\ref{ch:createExercisesSheets}). A more detailed
account of tasks occurring during a semester is given in 
chapter~\ref{ch:semsched}.
\end{enumerate}


\section{Prerequisites}

\subsubsection*{Personal}
To use the {\OKUSON} package as an administrator you need a working
knowledge of the following things:
\begin{itemize}
\item Editing of ASCII files with a text editor.
\item Installing and starting programs under UNIX.
\item Writing HTML.
\item Writing {\LaTeX} code for exercises.
\end{itemize}
In addition you should be willing to learn a few facts about XML (see
chapter \ref{ch:introXML}) and XHTML 1.0. And, if you want to know in some
detail how things work or if you want to add some functionality to the
package, you need knowledge about the programming language Python.

\subsubsection*{Technical}
To run the {\OKUSON} server you need a UNIX system that is accessible from
the internet (so, you may need help from an administrator if you are behind
a firewall). The following software must be installed:

\begin{itemize}
\item \textbf{Python} version 2.2 or later (as of this writing, 2.3 is
the latest version released). You can test your Python installation by
just typing \texttt{python} in your shell. If it is installed, a short
banner with the version appears. You can leave the interpreter again
by typing Control-D.

If you are using Linux, there are probably packages available for
your distribution. However, you can also download the source from
\href{http://www.python.org}{\texttt{http://www.python.org}} 
and install it without having root
privileges.
\item A \textbf{C-compiler}. {\OKUSON} uses an XML parser coming as an 
Python extension module, which is implemented in C. We include this
module in the {\OKUSON} distribution. However, it has to be built with your
version of Python being available. You also need the C-compiler to compile
the Python interpreter and libraries yourself if you do not rely on
packages from a distribution. Note that your python installation must be
fairly complete, in some Linux distributions you must install a package with
a name like python-dev or similar.
\item \textbf{\LaTeX}. The texts for questions are processed by {\TeX}, 
therefore one does need a full featured installation of {\TeX/\LaTeX} 
with PDF support. For example the teTeX-Distribution provides everything
necessary.
\item \textbf{ghostscript}. Exercise texts are translated to images for use
on the Web pages delivered by {\OKUSON}.
\item \textbf{netpbm}. A package for image conversions and manipulations,
the program \texttt{pnmtopng} leads to particularly small files for the
exercise text images. All Linux distributions probably have a
\texttt{netpbm} package, for other systems see
\href{http://netpbm.sourceforge.net}{http://netpbm.sourceforge.net}.
\item A \textbf{text editor}. Input for exercises, sheets and web pages
is generated with an ASCII text editor, which is also used to edit
the configuration.
\end{itemize}

If you want to use all features of {\OKUSON}, the following additional 
software packages are needed:
\begin{itemize}
\item A \textbf{web browser}. Not only the user access but also a great
deal of administrative tasks are done via the web interface, using
{\OKUSON}'s builtin web server. {\OKUSON} is tested with a wide range
of web browsers, including Mozilla and friends, Opera, Netscape, Lynx,
w3m, and even Internet Explorer.
\item A \textbf{PDF viewer} like \texttt{xpdf} or \texttt{acroread}. 
Previews of exercise sheets are generated as PDF files.
\item \texttt{xloadimage} is used to display test versions of exercises.
\item \texttt{less} is used to conveniently browse log files. 
\end{itemize}

The students participating in the courses organized with {\OKUSON} only 
need a web browser on any operating system and a PDF viewer to print out
their exercise sheets.

The following is \textbf{not} needed to run an {\OKUSON} server:
\begin{itemize}
\item Root privileges. A normal user can install and run an {\OKUSON}
server.
\item Web server. No web server apart from the one built into {\OKUSON} is
needed.
\end{itemize}


\section{Download}

You can download the {\OKUSON} distribution from the following web address:

\hspace*{1cm}\href{http://www.math.rwth-aachen.de/~OKUSON/}%
{\texttt{http://www.math.rwth-aachen.de/\~{}OKUSON}}

\noindent There you find this manual as a PDF file and a gzip'ed tar archive
containing the source code. You can extract the contents in any place in
the filesystem that is convenient by the following command:

\hspace*{1cm}\texttt{gzip -dc okuson-XXX.tar.gz | tar xvf -}

This command creates a directory \texttt{okuson} in the current working
directory, under which the full distribution resides. This directory
will be called ``the {\OKUSON} home directory'' in the sequel.

The next step is to compile the \texttt{pyRXP} extension module.


\section{Compilation}

As {\OKUSON} uses the Python extension module \texttt{pyRXP} which builts 
on the XML parser \texttt{RXP} written in C, some compilation is necessary.
Assuming that you have extracted the distribution as described in the 
previous section, you can compile \texttt{pyRXP} with the following
commands:

\hspace*{1cm}\texttt{cd okuson/server ; ./makepyRXP}

\noindent After the compilation you should find two files \texttt{pyRXP.so} and 
\texttt{pyRXPU.so} in this directory. Otherwise, please look for error 
messages in the output.

\noindent You can now leave the \texttt{server} directory again with

\hspace*{1cm}\texttt{cd ..}

\noindent The next step is to edit the configuration.


\section{Configuration}

In the  {\OKUSON} home  directory (the  directory \texttt{okuson}  which was
created during  extraction of  the archive)  there is a  file with  the name
\texttt{Config.xml.sample}. It is a sample file for the file 
\texttt{Config.xml}, which is the  central  place  for configuration  of  the
{\OKUSON} server. In the beginning, you should copy the sample file to
the real one with the command:

\hspace*{1cm}\texttt{cp Config.xml.sample Config.xml}

This file is  an XML file (see  section~\ref{ch:introXML}
for a short introduction) that can be edited conveniently with an ASCII text
editor.  It tries  to  explain  itself via  embedded  comments.  For a  full
description of the available configuration options see chapter~\ref{ch:config}.

For a start and to get an impression adjust the first few entries in 
this file, say \texttt{AdministratorPassword}, \texttt{CourseName},
\texttt{Semester}, \texttt{Lecturer}, \texttt{Feedback} and maybe
\texttt{Port}.

Note that the administrator password is stored encrypted, use the script
\texttt{cryptpasswd} in the {\OKUSON} home directory  to find an encryption 
of your password.

%%  For a start, you need to edit at least  two configuration options:
%%  
%%  \texttt{AdministratorPassword} and \texttt{Port}
%%  
%%  (and maybe some more of the obvious options in the beginning of the
%%  configuration file).
%%  
%%  The administrator password is used for authentication purposes during
%%  administration. It is only stored encrypted. You can use the little
%%  program \texttt{cryptpasswd} in the {\OKUSON} home directory to create
%%  an encrypted version of your password to put it into the configuration
%%  file.
%%  
%%  The port is the network port the {\OKUSON} server is listening to on the
%%  local host. The default value is $8000$, which should usually not be used
%%  by other programs. The {\OKUSON} server actually \textbf{is} a web server
%%  listening on this port. Check with your system administrator that the computer
%%  running the {\OKUSON} server can be contacted on the port you choose here.


\section{Getting started}

{\OKUSON} has a builtin web server and does nearly all its user
interaction via a  web interface.

The package contains a set of sample web pages (in German) and to get 
started just copy them into the subdirectory \texttt{html} (which is the
document root of the builtin web server in the default configuration). 
This is done with the following command, issued from the {\OKUSON} home
directory:

\hspace*{1cm}\verb!cp -r html.sample/* html!

The stuff that is copied with the abovementioned command consists of
\begin{itemize}
\item Style sheets with the extension \texttt{.css}.
\item Web page templates with the extension \texttt{.tpl}. These are
processed by the {\OKUSON} web server during startup and then delivered
to the web browser.
\item A few images with the extension \texttt{.png}.
\end{itemize}
Note that most  of the functionality of the {\OKUSON} server
is driven by these web pages. Their structure and content lead the user
through the menu system, organizes input and output from the server
and is therefore essential. 

In chapter~\ref{ch:webpages} we explain how to customize these web pages for
your course.

An {\OKUSON} server collects data about participants of your course,
submitted solutions of exercises, tutoring groups, \ldots Such data are
stored in the subdirectory \texttt{data}. 
For a start you need empty versions of the data files. This can be achieved 
by the following commands:

\hspace*{1cm}\verb!cd data ; cp empty/* . ; cd ..!

This copies the empty versions of the data files to the
real versions. Please do not do this later, when your server already
has accumulated data!

\section{Starting and Stopping the Server}

You can now try out the {\OKUSON} server by typing 

\hspace*{1cm}\texttt{start}

in the {\OKUSON} home directory. (Be patient, the first time you
call this some images of exercise texts are generated before the server can
start serving.) If everything went well, you
see some log messages, concluding with

\hspace*{1cm}[TIMESTAMP] \ \texttt{Ready to start service ...}

Otherwise, you have to read through the log messages and identify error 
messages, which start with ``\texttt{Error:}''. You also find the complete
log file under \texttt{log/server.log} in the {\OKUSON} home directory.

If the server was started up successfully, you can test it by
pointing your browser to the following URL:

\hspace*{1cm}\href{http://localhost:8000/index.html}%
{\texttt{http://localhost:8000/index.html}}

where the main menu for students should appear. Note that the
``\texttt{:8000}'' in this URL tells the browser to contact the
{\OKUSON} server on port $8000$. Therefore this has of course to be
changed according to the network port you chose during configuration.

If you want to stop the server, you can issue the command

\hspace*{1cm}\texttt{stop}

in the {\OKUSON} home directory.
The server finishes the ongoing requests and then terminates showing a few 
log messages.

There is also a script 

\hspace*{1cm}\texttt{restart}

that stops the server and restarts it. In general, whenever you change
something in the servers setup (say, you add or change exercises or sheets,
add some data in the \texttt{data} directory, change some web page, \ldots)
you must restart the server. The advantage of this approach is that you can
play around with your changes before they are published to the outside world
by the server (and the server is more efficient, because it caches and
preparses everything it needs during startup).

\section{Tips and Tricks: Security, Backup, \ldots}\label{sec:insttips}

In this section we mention some details of our own use of this package.
Maybe you find some of these remarks useful.

\subsubsection*{Using a Pseudo User}

We always create a pseudo user as administrator of the package. This makes
it easy to share the administration between several people without fiddling
around with strange file access settings in private directories.

We close completely (\verb+chmod 700 ~+) the access to the pseudo users
home directory. Note that during the semester the {\OKUSON} server collects
and stores personal data of the participating students. So, you must be
careful with the access to these data.

\subsubsection*{Securing the Administrator Access}

We always choose a very restricted setting for the machines from which 
administrator access to an {\OKUSON} server is allowed, see the entry
\texttt{AdministrationAccessList} in the configuration file
\texttt{Config.xml}. 

Note that the administrator of an {\OKUSON} server is quite powerful:
in all web forms of the system where a password (of a participant, a tutor or
the administrator) is required, the
administrator password is considered valid \emph{provided} the request is
coming from a machine with administrator access. As administrator you can
see sheets which are not yet open, submit solutions to closed sheets, change
a user password, get any users sheets and results and use the /adminmenu.html 
functions.

\subsubsection*{Make Sure Your Server Uses the Correct Time}

Since an {\OKUSON} server is very strict about accepting submitted solutions
as long as a sheet is open and showing the grading after a sheet is closed,
it is very important that the server uses the correct local time. Otherwise
expect unpleasant discussions with your students, some of them tend to hand
in their solutions in the last minute.

We use the network time protocol (NTP) service on our machines, using the
\texttt{ntpdate} program.

\subsubsection*{Backup}

Since the data collected by an {\OKUSON} server can be relevant for grades
it is important to have a good backup system for them.  

We use a machine different from the one running the {\OKUSON} server for
this. It has the GNU version of the \texttt{cron} program installed and 
we define (as the {\OKUSON} pseudo user) \texttt{crontab} entries like:

\begin{verbatim}
   MAILTO=""
   */5 * * * * ~/okusonsync 
   10 * * * * ~/okusonarchive
\end{verbatim}

Here, the scripts \texttt{okusonsync} and \texttt{okusonarchive} are in the
pseudo users home directory and look as in the following examples (using the
\texttt{rsync}, \texttt{tar}, \texttt{gzip} and \texttt{ssh} programs,
assuming that the pseudo user can login from the backup machine to the
server machine with ssh without password).

\begin{verbatim}
   #!/bin/sh
   ##  okusonsync       syncronizes an OKUSON installation using rsync

   BACKUPDIR="..."
   ORIGSERVER="..."
   ORIGDIR="..."  # no final '/'

   cd $BACKUPDIR
   rsync -a --delete -e ssh $ORIGSERVER:$ORIGDIR .
\end{verbatim}

and

\begin{verbatim}
   #!/bin/sh
   ##  okusonarchive          packs whole backup into an archive

   BACKUPDIR="..."
   DIRNAME="..."

   cd $BACKUPDIR
   fname=`date +"BACKUP-%Y-%m-%d_%H_%M_%S.tgz"`
   tar czf $fname $DIRNAME
\end{verbatim}

In this setup, every five minutes all files of an {\OKUSON} installation 
are synchronised to the backup machine (this takes a split second after the 
first time). And once an hour all files are packed and compressed, archiving 
the precise status of the whole system.

(Furthermore we have a daily backup of all data on all machines in our 
institute.)

These precautions allow a quick recovery of most or all data after a
possible crash or data corruption of the original server.

\subsubsection*{Restarting Server after Reboot}

Usually, our server machines are never rebooted. But in case that happens
for some reason (e.g., a power failure) it is desirable that the downtime of
the {\OKUSON} service is as short as possible. For this we use an entry
in the GNU \texttt{crontab} of the pseudo user on the server machine like

\begin{verbatim}
   @reboot  /my/okuson/dir/start
\end{verbatim}


\subsubsection*{Alias for Server Machine}

We create an alias for the machine running the {\OKUSON} server. 
This allows a quick move of the whole service to another machine, in case
the server crashes for some reason.

\subsubsection*{\emph{Paperless} Courses}

With the exception of exam exercise sheets we do not print any paper for
courses with {\OKUSON} exercises. Registration, exercise sheets, 
announcements, exam results, final grades are \emph{only} available via the
{\OKUSON} server web interface. Our experience was that  no students complain
about this approach.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Short Introduction to XML}\label{ch:introXML}

XML is a standard by the W3C consortium ({\texttt http://www.w3c.org}) that
allows to define \emph{markup languages} for text documents and data such 
that documents using such a language can be checked and processed 
systematically with generic tools.

The {\OKUSON} package uses XML in several places:
\begin{itemize}
\item its configuration file \texttt{Config.xml} 
\item the files specifying exercise sheets (\texttt{xxx.bla})
\item the files containing the interactive exercises (\texttt{yyy.auf}) -
but the exercise texts are written in {\LaTeX}, a much more complicated
markup language
\item the delivered Web pages are written with XHTML markup and the
templates for these pages are written with an XML markup  
\end{itemize}

The markup languages in each of these cases are different, but they are
almost self explaining and we provide sample files for all of them. 

In this Chapter we give a basic introduction to the XML concept. This
knowledge may be useful to avoid syntax errors and to understand the messages 
of programs parsing an XML file containing errors and to correct such errors.

\section{An Example XML Document}\label{sec:exampleXML}
\label{sec:XMLbasics}

Here is a complete XML document. Below we give a short glossary  and explain
the main concepts of the markup.

\begin{verbatim}
<?xml version="1.0" encoding="ISO-8859-1"?>

<!DOCTYPE MainElt SYSTEM "nowhere.dtd">

<!-- This is a comment.          -->

<MainElt>

<A xattr="val of xattr">abc<B yattr='contains " quotes'></B></A> 

<EmptyElt />

<Long><![CDATA[
Protected <A> <B> XXX </A> </B>
]]></Long>

<Short>With &lt; entities &gt; and ampersand &amp; </Short>

</MainElt>

\end{verbatim}

An XML document usually starts with some meta-information.

The first line \texttt{<?xml \ldots} just tells that this is a document with
an XML defined markup.

The \texttt{<!DOCTYPE MainElt SYSTEM "nowhere.dtd">} line specifies the
language to which the markup belongs by pointing to the file name of a so 
called \emph{document type definition} (DTD). It also tells that the actual
content of the document is enclosed by \texttt{<MainElt \ldots>} and
\texttt{</MainElt>}.

The actual content of an XML document is structured by so called
\emph{elements}.  They
basically have the form \texttt{<A>something</A>}. Here \texttt{<A>} is called 
the \emph{begin tag} and \texttt{</A>} the \emph{end tag} of the element and 
\texttt{something} is the \emph{content} of the element.

The \emph{name} of an element, here \texttt{A}, is case sensitive, that is
\texttt{<A></A>} and \texttt{<a></a>} are different elements. 

There always must be a begin and end tag. A begin tag can contain further
information as in \texttt{<A xattr="val of xattr">} above. 
This extra information is called an \emph{attribute}, where
\texttt{xattr} is the \emph{name} of the attribute and \texttt{val of xattr}
is the \emph{value} of the attribute. An attribute must always have a value
and the specification of the value must be enclosed either in double
quotes (\texttt{"}) or in single quotes (\texttt{'}). The enclosing quotes
are not allowed within the value.

Contents of elements can themselves contain strings and/or other elements. But
elements must always be properly nested, as in the line 
\texttt{<A xattr=\ldots} above, for example \texttt{<A> <B> XXX </A> </B>}
is \emph{not allowed}.

Anywhere before or after all elements or in the content of an element there
can be a \emph{comment}. This is specified by enclosing it in
\texttt{<!--} and \texttt{-->}, the only character sequence not allowed in a
comment is \texttt{--}. A comment is \emph{not} part of the content of an
element. 

There can be elements whose content is always empty and which can be written
with a combined begin and end tag as in \texttt{<EmptyElt />}, these are
called \emph{empty elements}.

Sometimes the content of an element is a string which looks like containing XML 
markup. There are two possibilities to avoid an interpretation as markup.

The first is demonstrated in the \texttt{Long} element above, its content is
enclosed in \texttt{<![CDATA[} and \texttt{]]>}. Everything between these
markers is considered as content as it is. The only string not allowed
within such a CDATA section is \texttt{]]>}. (Note that the line
\texttt{Protected\ldots} is just element content and that there is no syntax
error.)

The other possibility are so called \emph{entities}. They are demonstrated
in the \texttt{Short} element of our example. They start with an ampersand
\texttt{\&} and close with a semicolon \texttt{;}. Entities are placeholders
for which a substitution text is somewhere defined. For example, the given
entities \texttt{\&lt;}, \texttt{\&gt;} and \texttt{\&amp;} specify the special
characters \texttt{<>\&} used for XML markup.

A document type definition (DTD) defines a markup language in the sense that
it says which elements are allowed in a document, which attributes are
allowed for each element and how elements can or must be nested. We don't
explain this in more detail here. The {\OKUSON} package has a directory
\texttt{dtd} containing the definitions of the markup used in this package.

\subsubsection*{Summary}
XML documents contain elements which must be empty or have begin and end
tag and which must be properly nested. Element names are case sensitive.
Elements can have attributes which
must have a value and the value must be enclosed in double or single quotes.
There a CDATA sections and entities for specifying content containing the
special characters used for XML markup.

\subsubsection*{Reference}
A detailed specification of the XML standard with useful annotations
is given in\\
\mbox{}\hspace{1in}\texttt{http://www.xml.com/axml/axml.html}.

\section{Parsing and Validating XML Documents}\label{sec:valXML}

The main advantage of using  XML for new document formats (like the exercise
sheets and exercises in \OKUSON) is that one can use standard tools to read
in and process the content of such documents. Programs which read  XML
documents  and translate it to some internal data structure are called
\emph{XML-parser}. 

XML documents that follow the formal rules explained 
in~\ref{sec:XMLbasics} and so can
be parsed are called \emph{well formed XML documents}. This does not imply
that a documents makes any sense. 

As mentioned above the \texttt{DOCTYPE} entry of an XML file can point to a
document type definition. This defines element  names and gives restrictions
how elements can or must be nested, gives some information on the type of
content of certain elements, and it  defines for each element which
attributes are allowed and maybe some restriction on their values.

An XML  document which is  consistent with  the definitions in  its document
type is called  a \emph{valid XML document}. Some XML  parsers, like the one
we use  in the {\OKUSON}  programs, can check if  an XML document  is valid.
Such a parser is called a \emph{validating parser}. It is useful 
for the user who wants to check if a newly created document has the correct XML
structure, and it is useful for the programer as a general tool for checking
the formal correctness of XML input.

As administrative user  of {\OKUSON} you can come across  the parsing of XML
files when you use the testscripts for exercise and exercise sheet documents
(see~\ref{ssec:checkexercise} and~\ref{ssec:checksheet}) and during startup
of the {\OKUSON} server when the template files for the web pages are
cached.

\subsubsection*{Validating and Checking Well Formedness}

In the {\OKUSON} home directory, there is a script \texttt{xmlvalidate}
which can be used to validate XML documents. (With \texttt{-w} argument it
is only checked if a document is well formed.) In case of an error, a
sensible message for removing the problem is printed.

\chapter{Creating Exercises and Sheets}\label{ch:createExercisesSheets}

The {\OKUSON} package delivers exercises via the web. There are two types of
exercises, \emph{text  exercises} for which written  solutions are necessary
and \emph{interactive  exercises} whose  solutions are  submitted via  a Web
interface  and  which are  automatically  graded  by the  {\OKUSON}  server.
The  interactive exercises  depend on  the  participant, they  consist of  a
(pseudo-)random  ordering and  choice of  variants of  some questions.  Such
exercises  cannot be  specified in  a  single static  \LaTeX-file, but  some
additional information is needed.

While the actual exercise texts must be written in \LaTeX, the additional
structure is added via some simple XML markup, see~\ref{ch:introXML}.
We provide for both types of documents templates which you can just copy and
fill in. While these are almost self explaining we describe the details in
this Chapter.

\section{Generalities on the Exercise and Sheet Files}

The directories containing exercises and sheets for an {\OKUSON} server must
be given  in the  configuration  file \texttt{\$OKUSONHOME/Config.xml},
see the \texttt{<ExerciseDirectories>} and \texttt{<SheetDirectories>}
elements. Each directory is given as a \texttt{DIR} element whose content
has the form \texttt{path/to/dir} or \texttt{path/to/dir|prefix}, the prefix
is used to distinguish exercises with the same name from different
directories, see~\ref{sec:Sheets}.

The default directories are \texttt{\$OKUSONHOME/exercises} and
\texttt{\$OKUSONHOME/sheets}, but you can change these and also use 
several directories for each or merge them into a single directory.

There are three types of files recognized by {\OKUSON} which are
distinguished by their file extensions as follows:
\begin{description}
\item[\texttt{.tex}] this is for text exercises, such a file
contains just the text of the exercise in \LaTeX-format.
\item[\texttt{.auf}] this is for files containing one or several interactive 
exercises, these are XML files with the actual exercise texts written in
\LaTeX.
\item[\texttt{.bla}] this if for files which specify one or several exercise
sheets. They contain some meta information like sheet number or submission
date and refer to the exercises to include, some intermediate texts can also
be given (in \LaTeX-format).
\end{description}

\subsubsection*{Which {\LaTeX} Macros?}

In the standard setup of {\OKUSON} the following packages and macros are 
loaded when \texttt{latex} is called: \texttt{inputenc}, with parameter
\texttt{latin1} which allows to use German umlauts and other western
European accented characters in the {\LaTeX} code; \texttt{graphicx} for
including images in exercises; \texttt{amssymb} which provides many
mathematical symbols; and finally macros \verb+\Z+, \verb+\N+, \verb+\Q+, 
\verb+\R+, \verb+\C+, \verb+\F+ as
abbreviations for \verb+\mathbb{Z}+, and so on. 

The {\LaTeX} templates used for producing the images of exercise texts for
the web pages and for producing the exercise sheets in PDF-format can be
found (and adjusted, if you know what you are doing) in the {\OKUSON}
configuration  file \texttt{\$OKUSONHOME/Config.xml}, see the elements
\texttt{<LaTeXTemplate>} and \texttt{<PDFTemplate>}.

If you just want to add the loading of some further packages or to read in
some of your favourite personal macros, use the \texttt{<ExtraLaTeXHeader>}
element of the configuration file.


\section{Writing Exercises}\label{sec:writeEx}

A text exercise used by {\OKUSON} is written in a separate file with
the extension \texttt{.tex}. Put only the \LaTeX-code of the exercise text
itself in that file.

We explain the format of an \texttt{.auf} file by an example that contains
all possible constructs. In practice one may copy the template file

\hspace{0.5in}\texttt{\$OKUSONHOME/exercises/empty.auf.template} 

and fill in the exercise texts.

\subsection*{An Example File \texttt{example.auf}}

This example  demonstrates all types of questions which can be posed
in interactive {\OKUSON} exercises. The example probably almost explains
itself, but read the comments below on the types of questions and how the
possible answers are specified.

{
\begin{verbatim}
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE EXERCISE SYSTEM "exercise.dtd">

<EXERCISE key="Example1" keywords="">

<ANSWERS type="r">Yes | No</ANSWERS>

<TEXT>
Let $a = \frac{2}{3}$ and $b = \frac{14}{7} \in \Q$ and 
set $c = 3a + 5$ and $d  = a + 7b$.
</TEXT>

<QUESTION>
<VARIANT solution="Yes">
The numerator of $a$ is $2$.
</VARIANT>
<VARIANT solution="No">
The denominator of $a$ is $2$.
</VARIANT>
</QUESTION>

<QUESTION>
<ANSWERS type="c">b | c | d </ANSWERS>
<VARIANT solution="b|c">
Mark the number(s) which are integers.
</VARIANT>
<VARIANT solution=" d">
Mark the number(s) which are not integers.
</VARIANT>
</QUESTION>

<QUESTION>
<ANSWERS type="s"></ANSWERS>
<VARIANT solution="30">
What is $3d+c$ (canceled down)?
</VARIANT>
<VARIANT solutionregexp="^4$|^9$|^14$">
Give an integer which is the sum of two of the 
numbers $a, b, c, d$.
</VARIANT>
</QUESTION>

</EXERCISE>
\end{verbatim}
}

As  usual  for  XML  documents  the   first  two  lines  say  that  this  is
an  XML  encoded  document  whose  document type  is  described  in  a  file
\texttt{exercise.dtd}  and whose  content consists  of an  \texttt{EXERCISE}
element.

The document type definition  is contained in {\OKUSON}s \texttt{dtd} 
subdirectory. We now explain all elements in this example, these
explanations include the rules given in the document type definition.

The \texttt{EXERCISE} element  marks one exercise. Its content is a sequence
of \texttt{ANSWERS}, \texttt{TEXT} and \texttt{QUESTION} elements. 

\texttt{TEXT} elements are used for text appearing before (and maybe between 
or after) the actual questions of the exercise. Their content consists of
{\LaTeX} code.

There can be at most one \texttt{ANSWERS} element. If it is there it
describes a default for the answers to all questions of this exercise.
This element has the form 
\texttt{<ANSWERS type="?">? | ? </ANSWERS>} with three possibilities for
the \texttt{type} attribute:
\begin{description}
\item[\texttt{"r"}] (radio button) this is for questions where several possible answers 
are given and exactly one of them is correct. In this case the content of
the \texttt{ANSWERS} element is a list of strings for the possible answers
which are separated by \verb+|+-characters. Leading and trailing whitespace
in each possibility is removed (so that \texttt{>Yes|No<} and \texttt{>  Yes |
No <} are interpreted the same).
\item[\texttt{"c"}] (multiple choice) this is for questions where several
possible answers are given, and some subset of them is correct. The syntax
for the content in this case is the same as for \texttt{"r"}.
\item[\texttt{"s"}] (string) this is for question where the answer is
expected as a string (that has to be typed into an input field). In this
case the content of the \texttt{ANSWERS} element should be empty.
\end{description}

The \texttt{QUESTION} elements are for the actual questions. Their content
is a sequence of at most one \texttt{ANSWERS} element and at least one
\texttt{VARIANT} element. In case there is an \texttt{ANSWERS} element, this
must have the same syntax as just described and it is taken as description
of the answers to all variants of the current question. If there is no
\texttt{ANSWERS} element, the default given in the content of the
\texttt{EXERCISE} element is taken. 

The content of each \texttt{VARIANTS} element is the {\LaTeX} code of a
question. The correct  solution to this question is specified in one of the
attributes \texttt{solution} or \texttt{solutionregexp}, more precisely the
syntax depends on the answer type of the question:
\begin{description}
\item[\texttt{"r"}] the solution must be given in the \texttt{solution} 
attribute and be exactly one of the answers given in
the relevant \texttt{ANSWERS} element (again, up to leading or trailing
whitespace).
\item[\texttt{"c"}] the solution must be given in the \texttt{solution}
attribute and be a subset of the answers given in the relevant
\texttt{ANSWERS} element, separated by \verb+|+-characters.
\item[\texttt{"s"}] the solution can be given either in the
\texttt{solution} attribute as list of possible answer strings separated by 
\verb+|+-characters (usually just one string), or it can be given in the 
\texttt{solutionregexp} attribute as a regular expression such that an
answer is correct if and only if it matches this regular expression. To be
precise: the given expression must follow the syntax documented in the
\texttt{re}-module of \texttt{python}, the matching is done with the
\texttt{search} method of regular expression objects in that module.
In any case in the solutions and submitted answers leading and trailing
whitespace will be deleted before the comparison.
\end{description}

\subsection*{Several Exercises in One Document}

It is possible to put several exercises as above into one document. In that
case the document should look like

\begin{verbatim}
<?xml version=``1.0'' encoding=``ISO-8859-1''?>
<!DOCTYPE EXERCISES SYSTEM ``exercise.dtd''>

<EXERCISES>

<EXERCISE>
   ...
</EXERCISE>
   
...

</EXERCISES>

\end{verbatim}

(note the entry \texttt{EXERCISES} in the \texttt{DOCTYPE} declaration).
There can be an arbitrary number of \texttt{EXERCISE} elements as explained
above.

\subsection*{Checking Exercises}\label{ssec:checkexercise}

The {\OKUSON} package contains a utility script for checking files with
interactive exercises as well as text exercises. 
The script assumes that you have the pager program
\texttt{less} and the image viewer program \texttt{xloadimage} installed on
your computer. The  script is called as follows:

\verb+          $OKUSONHOME/testexercise file1 file2 ...+

where \texttt{file1}, \texttt{file2} are exercise files with either
\texttt{.tex} or \texttt{.auf} extension. 

For each \texttt{.tex} file the {\LaTeX} code is processed as configured in
your {\OKUSON} installation and the result is converted to an image. If
there was a problem with the call of \texttt{latex}, the pager program
\texttt{less} is called with the log file describing the error. 

Otherwise, if an image could be successfully generated, this image is shown
with the help of the  image viewer \texttt{xloadimage}. Except for
the pixel resolution this is the image used to display the corresponding
exercise text to the course participants in the HTML version of the exercise
sheets.

For each given name of an \texttt{.auf} file this utility first parses the
file and checks if it is a valid document. If not, some error
message is printed giving the exact position in the file where a 
problem occured.

After a successful parsing of the file the utility considers each piece of
{\LaTeX} code given in some \texttt{TEXT} or \texttt{VARIANT} element.
Each such piece of text is checked as described above for an 
exercise text from a \texttt{.tex} file.


\section{Specifying Sheets}\label{sec:Sheets}

For exercise sheets in {\OKUSON} there is another XML document type which we
will also explain by looking at an example. Interactive exercises are referred
to by the value of their \texttt{key} attribute.
And text exercises are identified by their file names.

\subsection*{Example of an Exercise Sheet document}

\begin{verbatim}
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE SHEET SYSTEM "sheet.dtd">

<SHEET counts="1" 
       magic="2003"
       nr="0"
       name="0"
       first="1"
       openfrom="12:00_01.09.2003"
       opento="14:00_20.10.2003">

<TEXT>The first exercise is interactive. You must send the 
solution via the Web interface.</TEXT>

<EXERCISE key="Example1" prefix="" nrquestions="2" order="p" />

<TEXT>For the next exercise hand in a written 
solution to your tutor. </TEXT>

<INCLUDE file="fractions.tex"/>

<TEXT>Solutions for this sheet are accepted until 
Monday, Oct. 20, 2 pm.</TEXT>

</SHEET>
\end{verbatim}

The first two lines tell that the document is an XML document with a
document type specified in a file \texttt{sheet.dtd}.
The content of the file consists of a \texttt{SHEET} element.

A \texttt{SHEET} element has several attributes:
\begin{description}
\item[\texttt{nr}] must be the string of a non-negative integer. All sheets
must have different values for this attribute, which is used to order
all sheets numerically. 
\item[\texttt{name}] (optional, default value is value of \texttt{nr}
attribute) this is used as a name of the sheet that appears for example in
the header of the sheet, for example, it could be \texttt{name="Test 1"}.
\item[\texttt{first}] (optional, default value is \texttt{1}) fixes the
number of the first exercise on this sheet.
\item[\texttt{counts}] (optional, default value is \texttt{1}) determines if
this sheet is relevant for the grading of the course, value
\texttt{1} means \emph{yes} and value \texttt{0} means \emph{no}. 
\item[magic] string of some positive integer number smaller than $2^{32}$. This
is used in the pseudo-random choice of questions and variants in the
exercise sheets. Vary this value if you reuse a sheet or exercise to avoid
that people with the same identity get the same choices again.
\item[\texttt{opento}] this entry determines how long solutions for this
sheet are accepted. The value must be in the format \verb+hh:mm_dd.MM.yyyy+,
with \texttt{hh} the hour in the range $00..23$, \texttt{mm} the minutes in
the range $00..23$, \texttt{dd} the day of the month in the range $1..31$,
\texttt{MM} the month in the range $1..12$ and \texttt{yyyy} the year. This
time is interpretet as local time on the machine running the {\OKUSON}
server.
\item[\texttt{openfrom}] this is an optional entry with the same syntax as 
\texttt{opento}. If it is set to a time in the future then participants of
the course cannot get the sheet or submit solutions for it (But the
administrator can, so you can check and test a sheet before the course
participants can see it.) 
\item[\texttt{maxhomescore}] this is an optional entry specifying the 
maximal number of points a participant can achieve in his written homework
exercises on this sheet. Up to now this is not used in the rest of the
system.
\end{description}

The content of a \texttt{SHEET} element is a sequence of any number of 
\texttt{TEXT}, \texttt{EXERCISE} and \texttt{INCLUDE} elements.

The \texttt{EXERCISE} elements are empty elements with some  attributes:
\begin{description}
\item[\texttt{key}] the value must be the same as for a \texttt{key}
attribute of some exercise read before by the {\OKUSON} server.
\item[\texttt{prefix}] (optional, default value is the empty string) only
matches an exercise with the correct \texttt{key} which was loaded with the
given prefix. (This allows the use of several exercise directories, which
may contain exercises with the same keys.)
\item[\texttt{nrquestions}] (optional, the default is the number of
questions available in the exercise) the number of questions from this 
exercise which should be pseudo-randomly choosen for each 
sheet (there can be more questions in the exercise).
\item[\texttt{order}] (optional, default value is \texttt{"p"}) the value
can be either \texttt{"p"} which means that the pseudo-random choice for the
exercise sheets will permute the given questions; or the value can be
\texttt{"f"} which means that the ordering of questions is fixed such that
the questions will appear in the given order on each sheet.
\end{description}

The \texttt{INCLUDE} elements are also empty and have an attribute
\texttt{file} whose value is interpreted as name of a file containing a
text exercise. There is also the optional attribute \texttt{prefix} with the
same meaning and default as for \texttt{EXERCISE} elements.

The \texttt{TEXT} elements contain {\LaTeX} code of text which is included
in the exercise sheets before, between or after the specified exercises.

\subsection*{Specifying Several Sheets in One Document}

On can put several \texttt{SHEET} elements in one \texttt{.bla} file, but
these must be enclosed a \texttt{SHEETS} begin and end tag, and the
\texttt{DOCTYPE} declaration must tell that there is one \texttt{SHEETS}
element in the document.

\begin{verbatim}
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE SHEETS SYSTEM "sheet.dtd">

<SHEETS>

<SHEET>
  ...
</SHEET>
...

</SHEETS>
\end{verbatim}


\subsection*{Checking Sheets}\label{ssec:checksheet}

The {\OKUSON} package contains a utility script \texttt{testsheet} 
for checking  sheet files.
It produces a {\LaTeX} file and a PDF file of the given sheets containing all
questions in all variants, and containing a list of solutions of all
interactive exercises. The layout of the exercises is exactly as it should
look in the PDF versions of the exercise sheets of the course participants.

It maybe useful to check the individual exercises first with
\texttt{testexercise}, see~\ref{ssec:checkexercise}.

The syntax for this utility is

\verb+          $OKUSONHOME/testsheet file1.bla file2.bla ...+

For a sheet in \texttt{<file>.bla} with name \texttt{<name>} a {\LaTeX} 
file \verb+<file>_<name>.tex+ and a PDF file \verb+<file>_<name>.pdf+ 
are generated, if no error occurs.
These contain all variants of all questions and on an extra page the
solutions for the interactive exercises.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\chapter{The Web Pages}\label{ch:webpages}

We hope that the customization of the {\OKUSON} package for your 
application is possible by changing the basic entries in the
\texttt{Config.xml} file and by adjusting the template files for the web
pages delivered by the {\OKUSON} server. In this chapter we describe how the
web pages work. If you need further changes, please tell the {\OKUSON}
authors - maybe there are sensible generic extensions of the package which
fulfill your wishes.

\section{General Format of the Web Pages}

The  web   pages  delivered  by   the  {\OKUSON}  server  should   be  valid
with  respect  to   a  specification  from  the  W3C   consortium  which  is
called   \texttt{XHTML  1.0   Strict}. These are  combined  with   \texttt{CSS
2.0}   style  sheets   which  are   also  specified   by  that   consortium,
details can be found in~\href{http://www.w3c.org}{\texttt{http://www.w3c.org}}.  

Furthermore, we avoid the use of client side programs like \texttt{java} or
\texttt{javascript}, plugins or other features of web browsers which 
some people tend to switch off. 

This may sound quite tedious and restrictive on a first glance, but we see
several advantages:
\begin{itemize}
\item Participants of the course need very little prerequisites, which are
nowadays available on essentially any computer. 
\item Strictly following some official standard guarantees a predictable and
good appearance of the pages on all current web browsers and all
operating systems.
\item Having the page layout information (fonts, font-sizes, colors, border
sizes, \ldots) in style sheet files makes it easy to give all pages a
uniform appearance and to change this appearance for all pages at once.
\item Using the XML variant of the released HTML specifications allows to use 
standard tools for processing and checking such files (see
chapter~\ref{ch:introXML}).  Actually, most pages delivered by an {\OKUSON}
server are dynamically created from templates on demand. The templates are
also well formed XML documents, which allow an efficient preparsing and
processing.
\item There are  developments like MathML which will allow in the future to
include mathematical formulae directly in web pages (currently, we use
images for that). Also, a systematic processing of XML documents on the client 
side is already possible in new Web browsers. Such extensions will only work 
in combination with HTML pages which are strictly conform with some official
specification.
\item We can include in our builtin web server an automatic check of the
validity of all delivered web pages. (Non valid pages are still delivered,
but they are saved in temporary files for debugging and the validator 
icon is removed.)
\end{itemize}

The {\OKUSON} package comes with a complete set of sample web pages, they
are in the subdirectory \verb+html.sample+. Of course, the text of web 
pages is language dependent. Our sample pages are
written in German since we use the package in Aachen. But it should be
straight forward to produce versions in other languages.

If you want German pages as well for your course,  just copy all the
sample pages to the web directory given in your configuration file. 
Probably  only minor adjustments will be needed for your course, see the
next section for more details.

All sample pages are provided as template files with extension
\texttt{.tpl}. These are well formed XML documents and almost
\texttt{XHTML}, except for some extra tags.

The interface between the web pages and the {\OKUSON} server is described by
the meaning of these extra tags and by the names and meaning of input 
variables which are used in input forms for the course participants and for
the administrator. 

\section{How to Customize the Web Pages}

All web pages delivered by the  {\OKUSON} server are created by filling
template files (with extension \texttt{.tpl}) dynamically.

The placeholders in  the \texttt{.tpl}-files are easy to detect: While all
element names in XHTML are written with lower case letters, the 
{\OKUSON} placeholders are XML elements whose names start with  capital
letters.

There are placeholder elements with a simple global substitution text, and
others which denote some text that depends on a sheet number or on personal
data of a course participant. If you browse through the template files
distributed with {\OKUSON} you can probably often guess the meaning of such
an element from its name and location. So, we are not going to describe
everything in too much detail here, but try to give hints how to achieve likely
adjustments of the pages.

\subsection{What You Can Change Without Problems}

\begin{itemize}
\item The style sheet files with \texttt{.css} extension to change colors,
fonts, font sizes, margins, \ldots
\item All texts in the pages.
\item In particular the top page \texttt{index.html} could be 
redesigned, but you clearly want to include  links to the main functions of
the server: registration, change of registration data, getting the exercise
sheets and result information.
\end{itemize}

\subsection{What You Should Not Change}

\begin{itemize}
\item The component names in the HTML forms, these names explain the meaning
of the input data to the {\OKUSON} server. But you can take out or add some
components in these forms as explained below.
\item The names of many template files. In particular those in the
\texttt{errors} and \texttt{messages} directories, these files are used by
the {\OKUSON} server for error and success messages, as well as some others
which are used for the output of  internal functions in the server
(\texttt{sheet}, \texttt{result}, \texttt{reg\ldots}, \texttt{group\ldots},
\texttt{admin\ldots}, \texttt{exquery}).
If you change other file names make sure that you change links to these 
pages accordingly.
\end{itemize}

\subsection{Globally Defined Elements for Use in All Web Pages}

The following elements appear in almost all \texttt{.tpl} template files. 
They are substituted 
by the content of the elements of the same name in your configuration file:

\texttt{<CourseName/>}, \texttt{<Semester/>}, \texttt{<Lecturer/>},
and \texttt{<Feedback/>}.

For customization you can use elements \texttt{<User1>}, \ldots,
\texttt{<User9>} in the configuration file \texttt{\$OKUSONHOME/Config.xml} 
and include their content in the web pages via tags \texttt{<User1/>}, 
\ldots, \texttt{<User9/>}.

Furthermore the following elements are generally useful:
\begin{description}
\item[\texttt{<ValidatorIcon/>}] which includes an image in
the \texttt{images} directory with a link to the validating service of the
W3C consortium (it is only included if a page \emph{is} actually valid).
\item[\texttt{<CurrentTime/>}] which is substituted by a string describing
the local time of the delivery of a page. To get this string in a local
layout set the environment variable \verb+LC_ALL+ of the user starting the
{\OKUSON} server appropriately (say \verb+de_DE+ for German, see the
\texttt{man} page of \texttt{locale} on your system, often \texttt{locale
-a} lists the available settings).
\end{description}

A few other elements are available on all pages, but they are only sensible in
a special context, we list them shortly, see the sample web pages how they
are used. The elements with \texttt{Group} as part of their name correspond
to a distribution of the course participants into smaller groups for
tutoring. If you do not have such groups, ignore these elements.
See~\ref{sec:groups} for more details.

\begin{description}
\item[\texttt{<GroupSize number="??"/>}] number of participants in group
with given number.
\item[\texttt{<GroupDistribution/>}] sequence of HTML table rows (ID, number of
group), sorted numerically of alphabetically by IDs.
\item[\texttt{<GroupsOverview components="\ldots"/>}] sequence of HTML table rows, 
one for each group. See the comment in the sample file
\texttt{groupoverview.tpl} and~\ref{sec:groups} 
for possible \texttt{components}.
\item[\texttt{<MembersOfGroup number="??"/>}] comma separated list of IDs of 
participants in group with given number.
\item[\texttt{<AvailableSheetsAsButtons/>}] row of buttons for all available
sheets,  for use on query page for sheets.
\end{description}

\subsection{Special Elements in Pages Containing Personal
Data}\label{ssec:regelts}

There are  two pages for registration, one for the actual
registration and one for changing the personal data, see the sample pages
\texttt{registration.tpl} and \texttt{regchange2.tpl}. 
Other pages with personal data are the result query pages, see the sample
page \texttt{results.tpl}.


The following registration data  for each participant are stored by the
{\OKUSON} server: a user Id, last name, first name, the number of semesters the
participant has studied, (main) topic of studies, password (has to be given
two times when it is first specified or changed), 
email address, wishlist of other Ids for distribution into
tutoring groups and nine further fields for customization.

Each of these fields is connected with three names used in the web pages.
The first is a name of the input field in the registration form, the second
is an XML element name of a placeholder for the input field code with the
known value as default (for changing the registration data) and the third is
an XML element name of a placeholder for the value itself.

Here is a table giving these names.

\begin{tabular}{lccc}
description&form input name& input element placeholder&value placeholder\\
\hline
user id&id&\texttt{<HiddenIdField/>}&\texttt{<IdOfPerson/>}\\
last name&lname&\texttt{<LastNameField/>}&\texttt{<LastName/>}\\
first name&fname&\texttt{<FirstNameField/>}&\texttt{<FirstName/>}\\
semester&sem&\texttt{<SemesterField/>}&\texttt{<Sem/>}\\
main topic&stud&\texttt{<TopicField/>}&\texttt{<Topic/>}\\
password&passwd and passwd2&-&-\\
email&email&\texttt{<EmailField/>}&\texttt{<Email/>}\\
wishlist&wishes&\texttt{<WishesField/>}&\texttt{<Wishes/>}\\
person data 1&persondata1&\texttt{<PersonData1Field/>}&\texttt{<PersonData1/>}\\
\ldots&\ldots&\ldots&\ldots\\
person data 9&persondata9&\texttt{<PersonData9Field/>}&\texttt{<PersonData9/>}
\end{tabular}

Concerning the main topic of studies, one can suggest some common entries
which are specified in the configuration file, see the element
\texttt{PossibleStudies} in the config file and the sample registration 
web pages.

\subsection{Special Elements for Sheet Specific Data}\label{ssec:sheetelements}

There are some special elements used with the sheets in HTML format.

\begin{description}
\item[\texttt{<SheetNumber/>}] number of sheet.
\item[\texttt{<SheetName/>}] name of sheet.
\item[\texttt{<IfOpen>\ldots</IfOpen>}] content only included if sheet is still open.
\item[\texttt{<IfClosed>\ldots</IfClosed>}] content only included 
if sheet is no longer open.
\item[\texttt{<HiddenIdOfPerson/>} and \texttt{<HiddenNameOfSheet/>}] 
hidden input fields for submission form.
\item[\texttt{<WebSheetTable/>}] the actual table rows for the sheet, 
entries are images with exercise texts, includes input fields for submission of
interactive exercises.
\item[\texttt{<OpenTo/>} and \texttt{<OpenFrom/>}] closing and opening times
of sheet in readable format (same format as explained for  
\texttt{<CurrentTime/>}). 
\end{description}

\subsection{Special Elements for Tutoring Group Specific
Pages}\label{ssec:groupelements}

All information about tutoring groups is also exported for use on web pages
related to one such group. In~\ref{sec:groupinfo} it is explained how
this information can be given to the {\OKUSON} server.

\begin{description}
\item[\texttt{<GroupNumber/>}] the number of the group.
\item[\texttt{<GroupTutor/>}] the name  of the tutor.
\item[\texttt{<GroupPlace/>}] place where the group meets.
\item[\texttt{<GroupTime/>}] time when  the group meets.
\item[\texttt{<GroupEmailTutor/>}] the email address of the tutor.
\item[\texttt{<GroupIDs/>}] a comma separated sorted list (numerically or
alphabetically) of the IDs of the participants.
\item[\texttt{<GroupInfo1/>} to \texttt{<GroupInfo9/>}] further unspecified 
data for customization.
\end{description}

\chapter{Schedule of Events for one Course}\label{ch:semsched}
\chapter{Administration via the Web Interface}
\label{adminpages}

The configuration of the {\OKUSON} system and the creation of exercises and
sheets works with an ASCII text editor. For some other administrative tasks
however, the {\OKUSON} server offers a convenient web interface. You can
reach this by pointing your browser to the following URL, when the {\OKUSON} 
server is running:

\hspace*{5mm}\texttt{http://localhost:8000/adminmenu.html}

This assumes, that the {\OKUSON} server is running on the same machine than 
your web browser. If this is not the case, you have to substitute the name
of the server machine for ``\texttt{localhost}''. The same applies for the
port number \texttt{8000}, if you have configured your {\OKUSON} server
to listen to another port.

Note that there is an extra configuration option 
\texttt{AdministrationAccessList} to limit the IP range of machines, from
where the administration pages can be accessed (see 
\ref{AdministrationAccessList}). The default setting is to allow administrator
access only from the local machine.

In addition you have to authenticate yourself to the {\OKUSON} server
for every administrator operation. You can do this by entering the 
administrator password every time you start an operation. To make live
a bit easier we offer a cookie-based login procedure for this purpose to
avoid repeated password input. This works as follows:

To log in you have to visit the URL

\hspace*{5mm}\texttt{http://localhost:8000/adminlogin.html}

and type the administrator password. After login you are led to the
administrator menu, however, a secret number for this login session is
stored in your browser in a cookie. As long as the {\OKUSON} server is
not terminated and your browser still has this cookie value and you do
not login anew, you can perform administrative tasks without further
authentication. There is an option at the top of the administrator menu 
to log out again.

Note that the communication between your browser and the {\OKUSON} server is
not encrypted, such that everybody listening along the way could possibly
get administrator access. Therefore you should limit the administrator
access via the abovementioned IP ranges and log out after you are done
with administrative tasks.

\section{Administrative Tasks in the Administrator Menu}

You have the following options in the administrator menu:

\begin{itemize}
\item \textbf{Restart server}. This stops the {\OKUSON} server gracefully
and restarts it immediately. This is the same as launching the \texttt{restart}
script in the {\OKUSON} home directory. Note that you have to log in again
for further administrative tasks, as the login session is terminated 
automatically.
\item \textbf{Stop server}. This stops the {\OKUSON} server gracefully.
This is the same as launching the \texttt{stop} script in the {\OKUSON}
home directory.
\item \textbf{Export people for tutoring group distribution.} With this option
you can export data about all registered participants for the purpose of
distributing them into smaller tutoring groups. Usually this will be 
a semi-automatic process, that is described in chapter \ref{ch:managepeople}
below.
\item \textbf{Export people.} With this option you can export the personal
data of all registered participants into a single ASCII file. See
section \ref{ExportPersData} for a description of the data format produced.
You can choose among a number of orderings. There seems to be no immediate
application of this export facility, but it offers easy access to the
available personal data for private scripts and standard UNIX text
tools.
\item \textbf{Export participants of exam.} This export facility is to get
information about the registration situation for exams. Therefore the
exported data is restricted to ID, name, first name and the time stamp 
of the registration. See section \ref{ExportExamReg} for a description of
the data format and section \ref{ExamReg} for a description of how to
organize registration for exams conveniently.
\item \textbf{Export results.} This export facility produces information
about all the results of the participants, including multiplce choice
exercises, homework exercises, and exams. For the data format see section
\ref{ExportResults}. The obvious application of this export is at the
end of the semester to produce certificates for successful participants.
\item \textbf{Display available and future sheets.} This option gives
the administrator access to a page to display sheets exactly as the
page for regular participants, except, that also future sheets (which
have not yet reached their \texttt{openfrom} date) are accessible.
\item \textbf{Send message.} With this option one can send an individual
message to a certain participant. This message will appear on the page
where the participant queries his results. More
\end{itemize}

\chapter{Managing Participants}\label{ch:managepeople}

\section{Registration of Participants}

Once you start the server, participants can register via the {\OKUSON} web 
interface without  any administrational interaction. Registration is
possible as long as the service is running. 

Among the sample web pages coming with {\OKUSON} the template files
\texttt{registration.tpl} and \texttt{regchange2.tpl} are used for the
initial registration and change of personal data, respectively. 

Before you start the service check if the personal data collected on these
pages are what you need in case of your course. It is advisable to ask for
all data you may need later, e.g., for the grading and a possible
certificate in the end of the course. In chapter~\ref{ch:webpages} we have
explained the customization of the web pages, in particular in
section~\ref{ssec:regelts} we mentioned some customization variables you can
use for additional data. On the other hand you can just delete input fields 
in the registration pages which you do not need.

The most important datum of a registration is the ID of the participant,
which cannot be changed later. All data concerning a specific course
participant are stored by {\OKUSON} together with the corresponding ID.


\subsubsection*{IDs of Participants}

In our university there is a natural ID for each student (the "Matrikel" 
number)  which is often used. If you want to use other types of IDs, e.g.,
login names of the students choice, you can customize  the configuration option
\texttt{IdCheckRegExp} in \texttt{Config.xml}.

\subsubsection*{Visitor IDs}

Sometimes it is useful to have some visitor IDs which can be used with
arbitrary password and which do not appear in the export of user data or
result statistics. {\OKUSON} has the configuration option 
\texttt{GuestIdRegExp} for specifying such IDs.


\section{Distributing Participants into Tutoring Groups}\label{sec:groups}

We always accompany our exercises with regular meetings in a number of 
smaller groups with an assigned tutor. (The tutors check and grade the written
solutions of non-interactive exercises, and they discuss all exercises with
their group.)

You can tell the {\OKUSON} server about the membership of a course
participant in a tutoring group by numbering the groups (starting from 1,
the number 0 is a default number for people not (yet) put in one of those
groups), and by appending a line of the form

\verb+   someid:groupnumber+

to the file \texttt{data/groups.txt} (more precisely, the file configured
by \texttt{GroupFile}).

But, as you may know, for bigger courses, this distribution 
of the participants into tutoring groups is not easy, at least if you
want to fulfill wishes of participants to be together with some others.
{\OKUSON} helps you to complete this task in the following ways:

First (already at registration time), participants can enter a wishlist
of other students IDs with whom they want to be in the same group. {\OKUSON}
offers one input field, where participants can basically type in IDs of
other participants, usually separated by commas or whitespace.

Secondly you can export all registered people via the administrator pages 
(see \ref{adminpages}) using the button ``Export people for tutoring group
distribution''. You have the choice of exporting all participants together
(option ``all together'') or separated by their course of studies. Also you
can choose the data fields by which the output is sorted. The result
of this export is an ASCII file in a certain format (see
\ref{exportexclassformat}), that contains basically the IDs, the first and
last names, the semester number, the course of studies, the wishlist and
possible additional data you may collect of each participant.

This file is sent to your web browser with the content type 
\texttt{text/okuson}. This usually means that your browser --- not
knowing this type --- asks you, where it should store this file. It should
offer the default file name \texttt{peoplelistforgroups.txt}. Once you have
saved this file on your hard disk, you can use the following two scripts
in the \texttt{scripts} directory of your {\OKUSON} home directory:
\texttt{distribute.py} and \texttt{numbergroups.py}. The first
does a distribution of participants into groups thereby
fulfilling the wishes of participants as far as possible and forming as
many groups as you order. The second script just takes the result and
brings it in a format suitable to reimport it into {\OKUSON}. The 
result of \texttt{numbergroups.py} can be appended to 
\texttt{data/groups.txt}. After the next server restart the new
information is available to the {\OKUSON} server.

\subsection{Usage of \texttt{distribute.py}}

The input to \texttt{distribute.py} is an ASCII file with one line for
each participant (plus extra lines, see below). Each such line has to
be in the following format:

\hspace*{5mm}\texttt{id:last name:first name:semester:studiengang:wishlist:\ldots}

where \texttt{wishlist} is a comma separated list of valid IDs and the dots
in the end mean the 9 customization data \texttt{persondata1}, \ldots, which
may be empty. Lines
beginning with a hash \# character are ignored as comments. Empty lines
play a special role,  they separate so called ``parts'' of the
input. If you for example want to form groups for participants
of some course of studies separately, you can just separate the lists of
participants by empty lines, which is also done by the {\OKUSON} server,
if you select the option ``by course of studies'' during export. Via the
sorting options it is also easy to split into parts by other criteria.

The output of \texttt{distribute.py} has the same format, except that
empty lines now separate the groups into which the script has divided the
participants. Some comment lines have been added.

What does \texttt{distribute.py} do?

First it calculates for each part the finest equivalence relation with the
property, that all wishes (within the part) are fulfilled in the sense,
that any two participants where one had the other on his wishlist, are in
the same equivalence class.

Then it distributes these equivalence classes into a number of groups you
have specified on the command line (see below). To this end it uses the
following simple algorithm: It always puts the biggest equivalence class
left into the smallest group available. This algorithm works amazingly
well, because usually you will have lots of people without wishes, which
help to fill the groups in the end. Occasionally there will be one
equivalence class which is too big, thereby making one exercises class
which is bigger than all the others. See below how to overcome this
problem.

\texttt{distribute.py} is called with the following command line arguments:

\hspace*{5mm} \verb!scripts/distribute.py INPUTFILE OUTPUTFILE GROUPS {GROUPS}!

where \texttt{INPUTFILE} is replaced with the name of the input file,
\texttt{OUTPUTFILE} is replaced by the name of the output file and
these two file names are followed by as many numbers as there are parts
(separated by empty lines, see above) in the input. Each number specifies,
how many groups should be formed out of the corresponding part. Note that
the output file is overwritten and therefore should be different from the
input file.

The information about the equivalence classes is preserved in the following
way: between any two equivalence classes within the same group a comment
line is added, indicating the delimiter between equivalence classes.

\subsection{Usage of \texttt{numbergroups.py}}

The usage of \texttt{numbergroups.py} is even simpler. It is  called in
the following way:

\hspace*{5mm} \verb!scripts/numbergroups.py INPUTFILE OUTPUTFILE [FIRSTGROUP]!

where \texttt{INPUTFILE} is replaced with the name of the input file,
\texttt{OUTPUTFILE} is replaced by the name of the output file, and
\texttt{FIRSTGROUP} is an optional argument which selects the number
of the first group and defaults to $1$.

The script \texttt{numbergroups.py} just reads in the input file, reads
empty lines as group delimiters, ignores comments and writes out the
group distribution in the format the {\OKUSON} server needs it in the
file \texttt{data/groups.txt}. The import works just by appending the
result of \texttt{numbergroups.py} to the file \texttt{data/groups.txt}
and restarting the server.

\subsection{Strategies for Distribution}

We found that often the following strategy was good enough:

\begin{enumerate}
\item Export people ``all together''.
\item Run \texttt{distribute.py} once with the number of groups you want to
have.
\item Look at the output on the screen and decide whether the group sizes
are suitable.
\item Run \texttt{numbergroups.py} to prepare the input for {\OKUSON}.
\item Append it to \texttt{data/groups.txt} and restart the server.
\end{enumerate}

Because of the nature of this procedure with many intermediate steps you
can do manual interventions at all stages. For example you can divide the
output of the {\OKUSON} server by hand in a number of parts which are
handled separatedly. Or you can play around with the number of groups
(note that using $1$ for the number of groups basically gives you
statistics about the equivalence classes). In this way, you can overcome
problems with too big equivalence classes by manually separating them
into different parts. At last you also can look at the output of 
\texttt{distribute.py} and change the distribution before importing it
into the {\OKUSON} server via \texttt{numbergroups.py}.

Note finally that you can also separate different parts of the input into
different files manually and run the scripts on these files separately.
In the end you can put everything together by choosing the
\texttt{FIRSTGROUP} argument of \texttt{numbergroups.py} accordingly.

We hope that this whole procedure is flexible enough for all situations.

\section{Importing Information About the Tutoring
Groups}\label{sec:groupinfo}

If you are using the distribution of the course participants into tutoring
groups, there are pages among the {\OKUSON} sample web pages for publishing 
information on each group: number, meeting place and time, tutor, contact
address and also further infos that can be freely customized, see the
templates \texttt{groupoverview.tpl} and \texttt{groupinfo.tpl}. There is
also an encrypted password for each group. This can be used (and changed) by
the groups tutor for sending grading results of non-interactive homework 
exercises to the {\OKUSON} server, see below. The placeholder elements in
these template files are described in~\ref{ssec:groupelements}.

The import of these data for the existing groups is by appending one line
per group to the text file \texttt{data/groupinfo.txt} (more precisely, the
file  configured in entry \texttt{GroupInfoFile}). Each such line is a
sequence of entries separated by colons \texttt{:}. The entries are
interpreted in the following ordering:

\begin{description}
\item[nr] number of the group, a positive number.
\item[passwd] encrypted password for the tutors input access.
\item[tutor] name of tutor.
\item[place] place of group meeting.
\item[time]  time of group meeting.
\item[email] email address of tutor.
\item[groupinfo1 to groupinfo9] freely usable variables for customization.
\end{description}

Note that you could give pieces of HTML code containing appropriate links as
some of these entries. Note also that entries are separated by colons, within 
the entries you can encode a colon by typing \verb+\d+ instead.

\section{Input of Homework Results by Tutors}

There is a web page \texttt{/tutors.html} where tutors can request input
forms for homework exercise results, either for a particular member of the
group and all sheets, or for a particular sheet and all members of the
group. The groups password is needed for accessing these forms. This
password can also be changed via this request page.

Each result must be given in form of a total score and (maybe optionally) a
comma separated  list of partial results. You may specify the optional
\texttt{maxhomescore} attribute for your exercise sheets for later use with
grading or statistics.


\chapter{Import and Export of Data}

In this section we describe the export facilities of the {\OKUSON} server.
The basic idea is that most of the data within {\OKUSON} should be
accessible for the user in a well-defined way. The reason for this is that
it is impossible to foresee all the cases that may occur. Well-documented
export facilities make it easy for the user to reuse existing data in
private scripts or programs.

All the export facilities can be reached via the administrator's menu
(see \ref{adminpages}). They all send a file with content type
``\texttt{text/okuson}'' and your browser probably will ask you to save the
file, because it does not know what to do with this content type.
In all cases we send sensible default names along.

In this chapter we quickly go through the different options.

\section{Export of Personal Data of Participants}
\label{ExportPersData}

This export facility can be reached with the button marked ``Export
people'' in the administrator's menu. You can choose the data fields,
by which the output is sorted. The server sends a file with default
name ``\texttt{peoplelist.txt}''. In this file there is --- after some comment
lines beginning with a \#-character --- for every participant one line.
This line comes in the same format as the file \texttt{data/people.txt}
(see \ref{people.txt}), \textbf{except} that there is an additional
field, namely the number of the group in which the person is.

This means, that there are three reasons, why you should \textbf{not} copy
the output of this export directly to the file \texttt{data/people.txt}.
Apart from making no sense at all, you have to remove the last data field
with the group, and, what is probably worse, all colons and newlines that
may be contained in personal data fields are deleted or replaced by a 
space respectively, whereas in \texttt{data/people.txt} special precautions
are taken to store such data (see \ref{commonformat}).

So the fields in \texttt{peoplelist.txt} are separated by colons and
arranged in the following order:

\begin{center}
\begin{tabular}{|l|}
\hline
ID \\
\hline
last name \\
\hline
first name \\
\hline
semester number \\
\hline
studiengang \\
\hline
encrypted password \\
\hline
email address (possibly empty) \\
\hline
wishlist as typed in \\
\hline
personal data \#1 \\
\hline
personal data \#2 \\
\hline
personal data \#3 \\
\hline
personal data \#4 \\
\hline
personal data \#5 \\
\hline
personal data \#6 \\
\hline
personal data \#7 \\
\hline
personal data \#8 \\
\hline
personal data \#9 \\
\hline
group number ($0$ if not in any group) \\
\hline
\end{tabular}
\end{center}

Our intention for this export is to be able to access the current data
in the server easily with private scripts.

\chapter{Finetuning the Configuration}\label{ch:config}
\chapter{Customization Examples}
\section{Using IDs of Different Type}
\section{A Course Without Non-Interactive Homework Exercises}
\section{A Course Without Interactive Exercises}
\section{Managing Additional Personal Registration Data}
\section{Customizing the Look and Feel of the Web Pages}
\section{}
\chapter{File Formats}
\chapter{Internal Data Structures}
\chapter{Structure of the Program}
\appendix
\chapter{Differences Between XHTML and Other Variants of
HTML}\label{ch:diffHTMLXHTML}

If you know some HTML and compare it with the basics on XML as explained
in~\ref{ch:introXML} you see that the syntax rules for XHTML must be more
restrictive than for other (non-XML) variants of HTML. In particular note
the following details of XHTML:

\begin{itemize}
\item all tags must be written with lower case letters in the element names.
\item all non-empty elements must have a start- and end-tag, in particular
enclose paragraphs in \texttt{<p>} and \texttt{</p>} or list entries in
\texttt{<li>} and \texttt{</li>}.
\item attributes always must have an assigned value and the value must be
enclosed by either double or single quotes.
\item write empty elements like \texttt{<br />}, the space before the
\texttt{/>} is not necessary according to the specification but it helps
some old browsers to interpret it correctly.
\item do not put information on colors or fonts in the XHTML file. Instead
use the \texttt{.css} style sheet file. (For complicated cases use the
\texttt{class} attribute to mark elements for which you want to give special
formating rules in the style sheet.
\end{itemize}

?links to HTML 4.01 strict specification.

?validating scripts

\chapter{GPL}\label{ch:GPL}

Here is the text of the license under which the {\OKUSON} package is
distributed. Instead of this you may also take any newer version as
published in {\texttt http://www.gnu.org/licenses/gpl.html}.


{ \scriptsize
\begin{center}
{\parindent 0in

Version 2, June 1991

Copyright \copyright\ 1989, 1991 Free Software Foundation, Inc.

\bigskip

59 Temple Place - Suite 330, Boston, MA  02111-1307, USA

\bigskip

Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.
}
\end{center}

\begin{center}
{\bf\large Preamble}
\end{center}


The licenses for most software are designed to take away your freedom to
share and change it.  By contrast, the GNU General Public License is
intended to guarantee your freedom to share and change free software---to
make sure the software is free for all its users.  This General Public
License applies to most of the Free Software Foundation's software and to
any other program whose authors commit to using it.  (Some other Free
Software Foundation software is covered by the GNU Library General Public
License instead.)  You can apply it to your programs, too.

When we speak of free software, we are referring to freedom, not price.
Our General Public Licenses are designed to make sure that you have the
freedom to distribute copies of free software (and charge for this service
if you wish), that you receive source code or can get it if you want it,
that you can change the software or use pieces of it in new free programs;
and that you know you can do these things.

To protect your rights, we need to make restrictions that forbid anyone to
deny you these rights or to ask you to surrender the rights.  These
restrictions translate to certain responsibilities for you if you
distribute copies of the software, or if you modify it.

For example, if you distribute copies of such a program, whether gratis or
for a fee, you must give the recipients all the rights that you have.  You
must make sure that they, too, receive or can get the source code.  And
you must show them these terms so they know their rights.

We protect your rights with two steps: (1) copyright the software, and (2)
offer you this license which gives you legal permission to copy,
distribute and/or modify the software.

Also, for each author's protection and ours, we want to make certain that
everyone understands that there is no warranty for this free software.  If
the software is modified by someone else and passed on, we want its
recipients to know that what they have is not the original, so that any
problems introduced by others will not reflect on the original authors'
reputations.

Finally, any free program is threatened constantly by software patents.
We wish to avoid the danger that redistributors of a free program will
individually obtain patent licenses, in effect making the program
proprietary.  To prevent this, we have made it clear that any patent must
be licensed for everyone's free use or not licensed at all.

The precise terms and conditions for copying, distribution and
modification follow.

\begin{center}
{\Large \sc Terms and Conditions For Copying, Distribution and
  Modification}
\end{center}


%\renewcommand{\theenumi}{\alpha{enumi}}
\begin{enumerate}

\addtocounter{enumi}{-1}

\item 

This License applies to any program or other work which contains a notice
placed by the copyright holder saying it may be distributed under the
terms of this General Public License.  The ``Program'', below, refers to
any such program or work, and a ``work based on the Program'' means either
the Program or any derivative work under copyright law: that is to say, a
work containing the Program or a portion of it, either verbatim or with
modifications and/or translated into another language.  (Hereinafter,
translation is included without limitation in the term ``modification''.)
Each licensee is addressed as ``you''.

Activities other than copying, distribution and modification are not
covered by this License; they are outside its scope.  The act of
running the Program is not restricted, and the output from the Program
is covered only if its contents constitute a work based on the
Program (independent of having been made by running the Program).
Whether that is true depends on what the Program does.

\item You may copy and distribute verbatim copies of the Program's source
  code as you receive it, in any medium, provided that you conspicuously
  and appropriately publish on each copy an appropriate copyright notice
  and disclaimer of warranty; keep intact all the notices that refer to
  this License and to the absence of any warranty; and give any other
  recipients of the Program a copy of this License along with the Program.

You may charge a fee for the physical act of transferring a copy, and you
may at your option offer warranty protection in exchange for a fee.

\item

You may modify your copy or copies of the Program or any portion
of it, thus forming a work based on the Program, and copy and
distribute such modifications or work under the terms of Section 1
above, provided that you also meet all of these conditions:

\begin{enumerate}

\item 

You must cause the modified files to carry prominent notices stating that
you changed the files and the date of any change.

\item

You must cause any work that you distribute or publish, that in
whole or in part contains or is derived from the Program or any
part thereof, to be licensed as a whole at no charge to all third
parties under the terms of this License.

\item
If the modified program normally reads commands interactively
when run, you must cause it, when started running for such
interactive use in the most ordinary way, to print or display an
announcement including an appropriate copyright notice and a
notice that there is no warranty (or else, saying that you provide
a warranty) and that users may redistribute the program under
these conditions, and telling the user how to view a copy of this
License.  (Exception: if the Program itself is interactive but
does not normally print such an announcement, your work based on
the Program is not required to print an announcement.)

\end{enumerate}


These requirements apply to the modified work as a whole.  If
identifiable sections of that work are not derived from the Program,
and can be reasonably considered independent and separate works in
themselves, then this License, and its terms, do not apply to those
sections when you distribute them as separate works.  But when you
distribute the same sections as part of a whole which is a work based
on the Program, the distribution of the whole must be on the terms of
this License, whose permissions for other licensees extend to the
entire whole, and thus to each and every part regardless of who wrote it.

Thus, it is not the intent of this section to claim rights or contest
your rights to work written entirely by you; rather, the intent is to
exercise the right to control the distribution of derivative or
collective works based on the Program.

In addition, mere aggregation of another work not based on the Program
with the Program (or with a work based on the Program) on a volume of
a storage or distribution medium does not bring the other work under
the scope of this License.

\item
You may copy and distribute the Program (or a work based on it,
under Section 2) in object code or executable form under the terms of
Sections 1 and 2 above provided that you also do one of the following:

\begin{enumerate}

\item

Accompany it with the complete corresponding machine-readable
source code, which must be distributed under the terms of Sections
1 and 2 above on a medium customarily used for software interchange; or,

\item

Accompany it with a written offer, valid for at least three
years, to give any third party, for a charge no more than your
cost of physically performing source distribution, a complete
machine-readable copy of the corresponding source code, to be
distributed under the terms of Sections 1 and 2 above on a medium
customarily used for software interchange; or,

\item

Accompany it with the information you received as to the offer
to distribute corresponding source code.  (This alternative is
allowed only for noncommercial distribution and only if you
received the program in object code or executable form with such
an offer, in accord with Subsection b above.)

\end{enumerate}


The source code for a work means the preferred form of the work for
making modifications to it.  For an executable work, complete source
code means all the source code for all modules it contains, plus any
associated interface definition files, plus the scripts used to
control compilation and installation of the executable.  However, as a
special exception, the source code distributed need not include
anything that is normally distributed (in either source or binary
form) with the major components (compiler, kernel, and so on) of the
operating system on which the executable runs, unless that component
itself accompanies the executable.

If distribution of executable or object code is made by offering
access to copy from a designated place, then offering equivalent
access to copy the source code from the same place counts as
distribution of the source code, even though third parties are not
compelled to copy the source along with the object code.

\item
You may not copy, modify, sublicense, or distribute the Program
except as expressly provided under this License.  Any attempt
otherwise to copy, modify, sublicense or distribute the Program is
void, and will automatically terminate your rights under this License.
However, parties who have received copies, or rights, from you under
this License will not have their licenses terminated so long as such
parties remain in full compliance.

\item
You are not required to accept this License, since you have not
signed it.  However, nothing else grants you permission to modify or
distribute the Program or its derivative works.  These actions are
prohibited by law if you do not accept this License.  Therefore, by
modifying or distributing the Program (or any work based on the
Program), you indicate your acceptance of this License to do so, and
all its terms and conditions for copying, distributing or modifying
the Program or works based on it.

\item
Each time you redistribute the Program (or any work based on the
Program), the recipient automatically receives a license from the
original licensor to copy, distribute or modify the Program subject to
these terms and conditions.  You may not impose any further
restrictions on the recipients' exercise of the rights granted herein.
You are not responsible for enforcing compliance by third parties to
this License.

\item
If, as a consequence of a court judgment or allegation of patent
infringement or for any other reason (not limited to patent issues),
conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License.  If you cannot
distribute so as to satisfy simultaneously your obligations under this
License and any other pertinent obligations, then as a consequence you
may not distribute the Program at all.  For example, if a patent
license would not permit royalty-free redistribution of the Program by
all those who receive copies directly or indirectly through you, then
the only way you could satisfy both it and this License would be to
refrain entirely from distribution of the Program.

If any portion of this section is held invalid or unenforceable under
any particular circumstance, the balance of the section is intended to
apply and the section as a whole is intended to apply in other
circumstances.

It is not the purpose of this section to induce you to infringe any
patents or other property right claims or to contest validity of any
such claims; this section has the sole purpose of protecting the
integrity of the free software distribution system, which is
implemented by public license practices.  Many people have made
generous contributions to the wide range of software distributed
through that system in reliance on consistent application of that
system; it is up to the author/donor to decide if he or she is willing
to distribute software through any other system and a licensee cannot
impose that choice.

This section is intended to make thoroughly clear what is believed to
be a consequence of the rest of this License.

\item
If the distribution and/or use of the Program is restricted in
certain countries either by patents or by copyrighted interfaces, the
original copyright holder who places the Program under this License
may add an explicit geographical distribution limitation excluding
those countries, so that distribution is permitted only in or among
countries not thus excluded.  In such case, this License incorporates
the limitation as if written in the body of this License.

\item
The Free Software Foundation may publish revised and/or new versions
of the General Public License from time to time.  Such new versions will
be similar in spirit to the present version, but may differ in detail to
address new problems or concerns.

Each version is given a distinguishing version number.  If the Program
specifies a version number of this License which applies to it and ``any
later version'', you have the option of following the terms and conditions
either of that version or of any later version published by the Free
Software Foundation.  If the Program does not specify a version number of
this License, you may choose any version ever published by the Free Software
Foundation.

\item
If you wish to incorporate parts of the Program into other free
programs whose distribution conditions are different, write to the author
to ask for permission.  For software which is copyrighted by the Free
Software Foundation, write to the Free Software Foundation; we sometimes
make exceptions for this.  Our decision will be guided by the two goals
of preserving the free status of all derivatives of our free software and
of promoting the sharing and reuse of software generally.

\begin{center}
{\Large\sc
No Warranty
}
\end{center}

\item
{\sc Because the program is licensed free of charge, there is no warranty
for the program, to the extent permitted by applicable law.  Except when
otherwise stated in writing the copyright holders and/or other parties
provide the program ``as is'' without warranty of any kind, either expressed
or implied, including, but not limited to, the implied warranties of
merchantability and fitness for a particular purpose.  The entire risk as
to the quality and performance of the program is with you.  Should the
program prove defective, you assume the cost of all necessary servicing,
repair or correction.}

\item
{\sc In no event unless required by applicable law or agreed to in writing
will any copyright holder, or any other party who may modify and/or
redistribute the program as permitted above, be liable to you for damages,
including any general, special, incidental or consequential damages arising
out of the use or inability to use the program (including but not limited
to loss of data or data being rendered inaccurate or losses sustained by
you or third parties or a failure of the program to operate with any other
programs), even if such holder or other party has been advised of the
possibility of such damages.}

\end{enumerate}
}


\end{document}
